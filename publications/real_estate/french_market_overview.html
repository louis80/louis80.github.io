<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Cheat Sheet</title>

    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <link rel="shortcut icon" type="image/png" href="https://img.icons8.com/nolan/64/000000/programming-flag.png">
    <link rel="stylesheet" href="../../../css/style.css">

    <!-- code snippets -->
    <link rel="stylesheet" href="../../../packages/prism/prism.css">
    <script src="../../../packages/prism/prism.js"></script>

</head>
<body>
<!-- partial:index.partial.html -->
<div class="grid">
  <header class="header">
    <i class="fas fa-bars header__menu"></i>
    <div class="header__search">
      <input class="header__input" placeholder="Search..." />
    </div>
  </header>

  <aside id="includedSidenav" class="sidenav"> </aside>

  <main class="main">
    <div class="main-header">
      <div class="main-header__intro-wrapper">
        <div class="main-header__welcome">
            <div class="main-header__welcome-title text-light"><strong>Publication > Real Estate</strong></div>
            <div class="main-header__welcome-subtitle text-light"> An overview of the french real estate market </div>
        </div>
      </div>
    </div> <!-- end of header -->

    <!-- ############################################################### -->
    <article class='post'>
        <span class="title_article"><strong>An overview of the french real estate market</strong> </span>

        <span class="text_article">
          At the end of 2018, the French government published an open source dataset to meet an objective of transparency of the French real estate market.
          This data references the real estate transactions that took place during the last five years on the metropolitan territory.<br><br>

          The dataset is available from the French Ministry of Economy and Finance website:<br> https://www.data.gouv.fr/en/datasets/demandes-de-valeurs-foncieres/ <br><br>

          This short study aims to firstly explore, clean and analyse this dataset for, in a second time highlight some housing price related variables.
        </span>

        <span class="title_article"><strong>Part I. text</strong> </span>
        <span class="subtitle_article">Collecting and cleaning the data</span>
        <span class="text_article">
          As the dataset is quite huge, Etalab (a government organisation in charge of opening and sharing public data) implemented a bash script allowing to import the data into a database.
          Once this step achieved, it's easier to access the data needed with SQL request. <br><br>

          Each row of the database corresponds to a real estate transaction and for each of them a lot of variables are informed.
          However many of those are quite similar, therefore in order to achieve this study only few of them will be used:<br><br>

          # ARRAY # <br><br>

          As some value of important variables are missing, only rows with living space and surface of the property will be selected.
          In addition, the price per square meter will be calculated for each of those transactions and the scope of study will be restricted to the house and apartment transactions.<br><br>
        </span>

        <pre class="language-python"><code class="language-SQL">
        SELECT count(*)
        FROM public.dvf
        WHERE surface_reelle_bati is not null
        AND valeur_fonciere is not null
        AND type_local in ('Maison', 'Appartement');
        </code></pre>



        <span class="subtitle_article">Dealing with outliers</span>
        <span class="text_article">
          # TO BE MODIFIED<br>
          Outliers in real estate data could be due to a number of reasons.
          For example, erroneous data formats, bad default values, typographical errors during data entry etc. can lead to outliers.
          Plotting the distribution of numeric columns can give a sense of outliers in the data set.<br><br>

          Show code &nbsp;
          <label class="switch">
            <input type="checkbox" onclick="show_hide_div('code1');">
            <span class="slider round"></span>
          </label>
        </span>

        <pre class="language-python" id='code1' style="display:none;"><code class="language-python">
        # Connexion to the database
        import psycopg2

        def database_conn():
            return psycopg2.connect(host = '',
                                    port = '',
                                    database = '',
                                    user = '',
                                    password = '')

        def get_data_from_database(req):
            conn = database_conn()
            cursor = conn.cursor()
            cursor.execute(req)
            record = cursor.fetchall()
            names = list(map(lambda x: x[0], cursor.description))
            cursor.close()
            if (conn):
                conn.close()
            return record, names

        # Get the data to plot the distribution
        def get_df_distrib():
          req = """
          SELECT type_local AS type_property, ROUND(valeur_fonciere / surface_reelle_bati) AS price_msquare
          FROM public.dvf
          WHERE surface_reelle_bati is not null
          AND valeur_fonciere is not null
          AND type_local in ('Maison', 'Appartement');
          """

          record, names = get_data_from_database(req)
          df = pd.DataFrame(data= record, columns=names)

          return df

        df_distrib = get_df_distrib()

        # Plot the distribution of price per square meter
        fig = px.histogram(df_distrib, x="price_msquare", color="type_property",
                 marginal="box", opacity=0.6)

        fig.update_layout(title_text='Distribution of the price per square meter according to the type of property')

        fig.show()
      </code></pre>

      <iframe src= "plot_french_market_overview/distrib.html", width="100%", height="650px", frameBorder="0"></iframe>

      <span class="title_article"><strong>Part II. text</strong> </span>

        <!--<iframe src= "../../../name.html", width="100%", height="500px", frameBorder="0"></iframe>-->


      <span class="subtitle_article"><strong>Load dataframe from database</strong></span>


    </article>
    <!-- ############################################################### -->

  </main>


  <footer class="footer">
      <p><span class="footer__copyright">&copy;</span> 2019 LJPR</p>
      <p>Crafted with <i class="fas fa-heart footer__icon"></i> by <a href="" target="_blank" class="footer__signature">Louis jpr</a></p>
  </footer>
</div>
  <script>
    function show_hide_div(id) {
      if ($('#'+id).css('display') == 'none') {
        $("#code1").show(500);
      }else{
        $("#code1").hide(500);
      }
      return false;
    }
  </script>
  <script src='https://code.jquery.com/jquery-3.3.1.min.js'></script>
  <script src='https://www.amcharts.com/lib/3/amcharts.js'></script>
  <script src='https://www.amcharts.com/lib/3/serial.js'></script>
  <script src='https://www.amcharts.com/lib/3/themes/light.js'></script>
  <script defer src="../../../js/script.js"></script>
  <script defer type="text/javascript"> $("#includedSidenav").load("../../../sidenav.html");</script>

</body>
</html>
